---
title: "GLM Assignment"
author: "Mike Swofford"
date: "11/9/2019"
output: html_document
# GLM Assignment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#options(scipen = 999)
```

```{r packages, echo=FALSE, include=FALSE}
library(tidyverse)
```


```{r data, echo=FALSE, include=FALSE}
# Import of dataset file
telework <- read_csv("Telework.csv")
```

```{r clean, echo=FALSE, include=FALSE}
# Cleaning of data

# Change state variable to a factor
cols <- c("state", "rent_or_own_home", "type_of_home", "education",
          "marital_status", "sex", "citizenship", "full_or_part_time", 
          "hourly_non_hourly", "union_member", "geography_region",
          "hispanic", "industry", "occupation_group", "detailed_industry", 
          "detailed_occupation_group", "metropolitan", "msa_size", "race",
          "occupation_code", "csa_code", "msa_code", "telecommute")
telework[cols] <- lapply(telework[cols], factor)
```

## Question 1: Telecommuting and Income

First, we will look at a model of weekly earnings (income) as it directly 
relates to whether someone telecommutes or not. 

A simple one-way ANOVA provides these results:

```{r q1_anova, echo=FALSE}
# Question 1: ANOVA to measure weekly earnings as telecommute changes
q1 <- aov(weekly_earnings~telecommute, data = telework)
q1_result <- summary(q1)
print(q1_result)
```
This model suggests that whether or not someone telecommutes has an impact on 
their income. The resulting p-value, being less than 2e-16, tells us that, given
the confidence level of 95%, there is good certainty that the dependent 
variable here, weekly earnings, is affected by the status of the dependent 
variable, the boolean telecommute.

A boxplot gives graphical represenation that the range of income for those that
telecommute is higher than the range of those that do not:

```{r q1_plot, echo = FALSE}

telework %>%
  ggplot(aes(y=weekly_earnings, x=telecommute)) +
  geom_boxplot()
```


However, this should be considered a naive model for a couple of reasons:

1) Correlation between the variables should not imply causation. Logically, the
act of telecommuting is likely not in itself a driver of higher income. 
2) There may be other mediating variables in the data that give the appearance
of influence between these two selected variables. In this case, what is
more likely is that the type of occupation one has where telecommuting is an
option may drive higher income. 

## Question 2: Telecommuting, Income, and Full or Part-Time Status

A second model includes full or part-time status as a variable in addition to 
the telecommute status.

A two-way ANOVA gives these results:

```{r q2_anova, echo = FALSE}
# Question 2: Two-way ANOVA to measure weekly earnings as telecommute and 
# occupation type changes.

q2 <- aov(weekly_earnings~telecommute+full_or_part_time, 
          data = telework)
summary(q2)
```
In this model, both variables show significance, as the p-values in the above 
results are both very low. I.e. both telecommute status and full or part-time 
status show a correlation to income. 

There is logic to this model, as one would assume that holding full-time 
employment would have a direct influence on an increase in income, while a 
part-time worker would likely have a compartively lower income. 

Concerning the telecommute status, however, there may still be some correllation
to income, but this is likely mediated by the full-time/part-time status
variable. If that is the case, then this model still shows some naievety as
there is multicollinearity between the variables.

A boxplot of this model shows the similarities in the range variancess for
those that telecommute and those that do not. While weekly earning are higher
for full-time workers that telecommute, the similar dynamic between the ranges
of the two telecommute categories is apparent:

```{r q2_plot, echo = FALSE}

telework %>%
  ggplot(aes(y=weekly_earnings, x=telecommute)) +
  geom_boxplot() + aes(fill = full_or_part_time)
```

## Question 3: Simple Regression of Income / Hours Worked

Next is a simple linear regression model for weekly earnings (income) as a 
function of the number of hours worked.

The general equation for this model is: $$\hat Y = b_{0} + b_{1}X_{i}$$

Incorporating the above variables, the specific form for this model will be:
$$weekly~earnings_{i} = \beta_{0} + \beta_{1}(hours~worked)$$
The results of the regression are:

```{r q3_lm, echo = FALSE}

#q3 <- lm(weekly_earnings~hours_worked, data = telework)
summary(q3_result <- lm(weekly_earnings~hours_worked, data = telework))


#telework %>%
  #ggplot(aes(x=hours_worked, y=weekly_earnings))+
  #geom_point()+
  #geom_smooth(method="lm")

```

From this, the specific equation for the model is:

$$weekly~earnings_{i} = {`r (as.numeric(coef(q3_result)[1]))`} + {`r (as.numeric(coef(q3_result)[2]))`}(hours~ worked)$$





